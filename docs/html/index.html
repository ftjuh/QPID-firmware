<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QPIDfirmware: QPID firmware - Autonomous PID and encoder controlled motor driver</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="cupid_64p.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">QPIDfirmware
   &#160;<span id="projectnumber">v0.1</span>
   </div>
   <div id="projectbrief">Object oriented firmware for autonomous motor drivers with encoder based PID controller and flexible interface</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">QPID firmware - Autonomous PID and encoder controlled motor driver </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This is the QPID firmware framework for the Arduino IDE. It is built on the object oriented <a href="inherits.html"><b>QPID class hierarchy</b></a> for Arduino supported microcontroller platforms. The firmware acts as an autonomous, <a href="https://en.wikipedia.org/wiki/PID_controller">PID controlled</a> motor driver for up to 16 units of a motor with rotary encoder and up to two endstops, which receives commands remotely from some master device. Typical commands are 'run to position x', 'run at speed y', 'run to endstop', or self-calibrate'.</p>
<p>The system is designed with maximum flexibility in mind. It is meant to be able to support any kind of sufficiently powerful µC with Arduino support (ESP32, ATmega...), any kind of communication protocol (I2C, ESP-now, SPI, UART, Bluetooth...), any kind of motor (DC, stepper, brushless motors...), any kind of rotary position sensor (quadrature or single pulse encoders, potentiometers, angular hall sensors...), and any kind of endstops (digital, pinshared analog, I2C io expander...). Of course, mileage may vary. The actually available features and performance will be limited by the specific combination of hard- and software. At the moment many of the mentioned variants are not implemented yet. However, others can be easily implemented by adding a newly derived class to the QPID class hierarchy.</p>
<dl class="section note"><dt>Note</dt><dd>Under construction. Everything documented here is preliminary and subject to testing. For testing purposes, much that should be private is public, so do not expect to find all details explained. Much is already working, proof of concept for everything but the message/communication system is there.</dd></dl>
<p>QPID was created originally to develop an autonomous controller solution for the <a href="http://www.fischertechnik.de">fischertechnik</a> construction toy system (see <a href="https://forum.ftcommunity.de/viewtopic.php?f=33&amp;t=6789">this tread</a>), but can be adopted for other usages as well.</p>
<dl class="section user"><dt>Terminology</dt><dd></dd></dl>
<ul>
<li><b>QPID system</b>: a microcontroller running the QPID firmware which can control up to 16 QPID units.</li>
<li><b>QPID unit</b> (implemented in class <a class="el" href="class_q_p_i_d___unit.html" title="A QPID_Unit objects bundles access to three hardware components, a motor driver, an position encoder,...">QPID_Unit</a>): a combination of one motor driver, one rotary sensor and up to two endstops which is connected to a QPID system and can perform autonomous tasks like 'run to x' etc.</li>
<li><b>QPID subunit</b>: A QPID unit's motor driver, encoder, or endstop. Usually, a subunit's hardware has to be implemented in c++ as a QPID class derived from one of the generic classes <a class="el" href="class_q_p_i_d___motor_driver.html" title="Mostly abstract class that defines access methods and features for generic motors,...">QPID_MotorDriver</a>, <a class="el" href="class_q_p_i_d___encoder.html" title="Mostly abstract class for any kind of rotary encoder with optional filtering for jittery or error pro...">QPID_Encoder</a>, or <a class="el" href="class_q_p_i_d___endstop.html" title="Abstract class for any kind of endstop switch.">QPID_Endstop</a>.</li>
<li><b>Master</b>: a device which sends command messages to a QPID system and receives status messages via any of the implemented means of communication (I2C, ESP-easy...).</li>
<li><b>Client/Slave</b>: a QPID system receiving command messages and sending status messages.</li>
<li><b>Message</b>: a byte stream with predefined format containing commands or status reports. Command messages sent from the master can be directed to the QPID system, one of its units or one of a unit's subsystems. Only the QPID system (not one of its units or subsystems) can send status messages back to the master.</li>
</ul>
<dl class="section user"><dt>Practical usage</dt><dd></dd></dl>
<ol type="1">
<li>Adapt the firmware for your specific demands. Depending on the kind of motors, encoders, and endstops you plan to use, use existing subunit classes or add your own for subsystems not supported yet. Use an already implemented communication protocol or implement your own.</li>
<li>Build and upload the firmware for your platform.</li>
<li>Build your hardware setup: Connect motor drivers, encoders, and endstops to µC</li>
</ol>
<p>Usage from the master's viewpoint is as follows:</p>
<ol type="1">
<li>Establish a connection to the QPID system with one of the supported communication protocols, e.g. ESP-now.</li>
<li>Send a message for each QPID unit to initialize. For each QPID unit, the system needs to be informed about the type of motor driver, encoder, and endstops it uses.</li>
<li>Send a messge for each units' subunit to initialize/configure. Depending on the kind of hardware used, subunits need to be informed about which pins to use, or specific features like ticks per revolution for encoders etc.</li>
<li><p class="startli">After that the system is ready to receive regular command messages like 'run to x' etc. which it will perform autonomously and send status reports as requested by the master.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000001">Todo:</a></b></dt><dd><p class="startdd">check private, protected, public for all classes </p>
<p class="enddd">check use of 'override' for all derived classes (because in c++ everything* that makes more fool proob is either optional or not available at all)</p>
</dd></dl>
</li>
</ol>
<dl class="section user"><dt>Author</dt><dd>Copyright (c) 2021 juh</dd></dl>
<dl class="section user"><dt>License</dt><dd>This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, version 2.</dd></dl>
<p><a href="https://thenounproject.com/term/cupid/317554/">QPID logo</a> courtesy of <a href="https://thenounproject.com/oelhoem">Muhamad Ulum, ID</a> licensed under a <a href="https://creativecommons.org/licenses/by/3.0/us/legalcode">Creative Commons Attribution 3.0 United States license</a> </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sun May 23 2021 22:23:43 for QPIDfirmware by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
